<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Crash Course for Biologists, 2nd Edition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HZY3MS2C2R"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HZY3MS2C2R', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://EcoEvoGeno.org" class="navbar-brand navbar-brand-logo">
    <img src="./ColauttiLabLogo.png" alt="Colautti Lab logo" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://EcoEvoGeno.org">
    <span class="navbar-title">R Crash Course for Biologists, 2nd Edition</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">Book Info</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./preface.html">
 <span class="dropdown-text">Preface</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-basics" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Basics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-basics">    
        <li>
    <a class="dropdown-item" href="./fundamentals.html">
 <span class="dropdown-text">R Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./visualizations.html">
 <span class="dropdown-text">Quick Visualizations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rmarkdown.html">
 <span class="dropdown-text">R Markdown</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more-graphs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More Graphs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more-graphs">    
        <li>
    <a class="dropdown-item" href="./customizations.html">
 <span class="dropdown-text">Basic Customization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./advanced_vis.html">
 <span class="dropdown-text">Advanced Visualizations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multiplot.html">
 <span class="dropdown-text">Multi-plot Graphs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced">    
        <li>
    <a class="dropdown-item" href="./datascience.html">
 <span class="dropdown-text">Data Science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./flowcontrol.html">
 <span class="dropdown-text">Flow Control</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regex.html">
 <span class="dropdown-text">Regular Expressions I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regex2.html">
 <span class="dropdown-text">Regular Expressions II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./customfunctions.html">
 <span class="dropdown-text">Custom Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./matrices.html">
 <span class="dropdown-text">Matrices</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="./conclusion.html" aria-current="page"> 
<span class="menu-text">Conclusion</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link active" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
  <li><a href="#you-made-it" id="toc-you-made-it" class="nav-link" data-scroll-target="#you-made-it">You Made It!</a></li>
  <li><a href="#what-next" id="toc-what-next" class="nav-link" data-scroll-target="#what-next">What Next?</a></li>
  <li><a href="#support-open-accessible-science" id="toc-support-open-accessible-science" class="nav-link" data-scroll-target="#support-open-accessible-science">Support Open &amp; Accessible Science</a></li>
  <li><a href="#picture-a-coder" id="toc-picture-a-coder" class="nav-link" data-scroll-target="#picture-a-coder">Picture a Coder</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<section id="you-made-it" class="level2">
<h2 class="anchored" data-anchor-id="you-made-it">You Made It!</h2>
<p>Congratulations, you made it to the end of the book! Now you know all of the R fundamentals that I wish I had learned when I was an undergraduate working on my first research project. You may not feel like an ‘expert’ yet. However, take a moment to reflect on everything that you’ve accomplished by working through this book. Seriously, sit down with a pen or pencil and paper and try to make a list of everything you’ve learned. This is an important self-reflection exercise. You will hopefully surprise yourself to see how much you have learned in such a short time!</p>
<p>Okay, now I’ll try. First, you learned how to program in the command line by typing commands into the R Console in R Studio to produce an output. That alone is a major hurdle for many biologists! But you went even further, perhaps confronting hesitation or self-doubt about your ability to work with mathematical equations. You’ve learned how to translate equations into code, from simple addition, subtraction and multiplication to specific functions for the absolute value, square root, log, average, variance, and others. More importantly, you’ve learned the principles of coding that allow you to translate just about any equation into your very own custom R function. You got tied up with brackets, and brackets within brackets, within brackets to code more complicated equations.</p>
<p>You learned all about data frames (i.e.&nbsp;<em>flat</em> data or <em>2-dimensional</em> data) and all the useful functions from the <code>dplyr</code> library, like sub-setting, joining, sorting, grouping, and summarizing. You may not realize it, but this taught you how to work with <em>relational data</em>. Maybe you don’t call it this, but relational data are just data that <em>relate</em> to each other, which you learned to do with <code>dplyr</code> and <code>join_</code>. This is not much different than what advanced coders and data scientists do with large database protocols like <em>Hadoop</em> or <em>SQL</em>. These lie at the heart of user-friendly web tools for interacting with large online databases you may be familiar with, like <em>Climate Data Online (CDO)</em>, the <em>Global Biodiversity Information Facility (GBIF)</em>, or the many genetic and genomic databases maintained by the European <em>Molecular Biology Laboratory (EMBL)</em> and the <em>National Center for Biotechnology Information (NCBI)</em>.</p>
<p>You learned how to use logic operators with flow control and <code>dplyr</code> commands to string your functions together into an automated and reproducible workflow. You even learned how to write your own custom functions!</p>
<p>You learned how to work with naughty data, like missing values, mis-coded entries, and dates. Oh man, dates probably caused you so many problems until you leaned how to deal with them in R. You will never, ever, ever, work with dates in <em>Microsoft Excel</em>, if you can help it!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/excel.png" class="img-fluid figure-img" alt="A popular internet meme about Excel's propensity to recode data as dates"></p>
<figcaption>A popular internet meme about Excel’s propensity to recode data as dates</figcaption>
</figure>
</div>
<p>You ventured into the intimidating yet enchanting world of regular expressions. Once you start looking for opportunities to use regular expressions, you will start to see them in just about every data project you have, whether you are pulling out data with specific characteristics, or reformatting database entries by those who don’t understand the importance of strict data encoding practices. It’s unlikely you’ve masted regular expressions, especially if this was the first time you were exposed to these powerful spells. You just need to practice. The ability to code regular expressions will come with practice, which will enhance your power to help others and bring good to the world, not unlike the <em>Expecto Patronum</em>.</p>
<p>You learned everything you need to know to produce professional, publication-worthy visualizations of your data. You learned about important graphical concepts like data formats and colour palettes for publishing, and the layered ‘grammar of graphics’ philosophy. Even better, you learned how to wrap it all together in a reproducible and professional report with <em>R Markdown</em>.</p>
<p>Above all, you leaned how to embrace mistakes and troubleshoot your coding problems.</p>
<p>Although you have learned a lot, it’s natural to feel confused or unclear about some of the concepts and techniques you have encountered. In many cases, you may not yet be aware of your knowledge gaps.</p>
<p>That’s okay! You are now, officially, a real, <em>bona fide</em> coder. Coding for research is a lifelong learning process, and you will continue to encounter new challenges and opportunities to learn new tricks and techniques as you progress along your coding journey. You didn’t just learn how to code, you learned <em>how to learn</em> how to code. And, you deserve a massive, giant congratulations!</p>
<p>Sure, you have much to learn, but so does everybody else. Maybe you’ll meet a coder with a degree in computer science and a decade of experience coding for a major tech corporation. They will understand coding better than you, but you’ll probably be able to discuss coding better than they can discuss biology. Don’t get intimidated. Embrace the journey, not the destination.</p>
</section>
<section id="what-next" class="level2">
<h2 class="anchored" data-anchor-id="what-next">What Next?</h2>
<p>Where do you go from here? First, treat yourself. Maybe a vacation, or at least a dessert? You deserve it.</p>
<p>Don’t ever doubt that you are now a competent coder. You have a lot to learn, but don’t have to wait until you feel like an ‘expert’ to put your skills to good use. Look for opportunities to write and proofread code to hone your skills.</p>
<p>If you found that this book suited your learning style, then you might want to check out some of the other books and resources that we are developing.</p>
<ol type="1">
<li><p><code>EcoEvoGeno.org</code> is our main, public-facing website and it contains links to our latest book releases as well as general information about our research and lab activities.</p></li>
<li><p><code>ColauttiLab.github.io</code> is our training ‘resources’ website, with a variety of advice and helpful links for new and established researchers. It’s directed at the graduate students in our lab, but many of these resources may be useful to you.</p></li>
<li><p><code>github.com/ColauttiLab</code> is our github page, where you can search our repositories to see what we are currently working on.</p></li>
<li><p><em>R STATS Crash Course for Biologists</em> is the next book in this series. If you are going to work with biological data in R, then you probably will want to learn how to run statistical models. The <em>R STATS Crash Course for Biologists</em> covers this, from the most basic ANOVA and linear regression to advanced Generalized Additive Mixed Effects Models.</p></li>
<li><p>The third book planned in this series, or possibly published by the time you read this, is <em>R Machine Learning Crash Course for Biologists</em>. Once you understand statistical models, the <em>R Machine Learning Crash Course for Biologists</em> will guide you through common <em>supervised</em> and <em>unsupervised</em> machine learning models, including a deep-dive into the Principal Components Analysis (PCA) mentioned briefly in the <em>R Fundamentals</em> Chapter. In addition, you’ll learn how to run Regularized Discriminant Analysis, Support Vector Machines, and Decision Trees to make predictions.</p></li>
<li><p>The fourth book planned is <em>Bioinformatics Crash Course for Biologists</em> which adds training in Python and Unix for high-performance computing, and then focuses on specific applications in bioinformatics like genome assembly and annotation, gene expression analysis, microbiome analysis, and population genetics.</p></li>
</ol>
<p>If you have any thoughts you would like to share, good or bad, please get in touch. If you have criticisms, please send them to me so that we can improve future editions of the book. You can find up-to-date contact information on our lab website: <em><a href="https://EcoEvoGeno.org" class="uri">https://EcoEvoGeno.org</a></em></p>
</section>
<section id="support-open-accessible-science" class="level2">
<h2 class="anchored" data-anchor-id="support-open-accessible-science">Support Open &amp; Accessible Science</h2>
<p>If found this book helpful, please consider supporting us. We work hard to keep the cost low for our printed versions and the proprietary electronic versions (e.g.&nbsp;Kindle, Kobo, Apple, Google). Rather than pay publishing cartels or professional editors, all of the proceeds from these versions support graduate students to help make new content available, including translations to other languages and beta testing new tutorials for future books.</p>
<p>Our team is passionate about demystifying math and coding for biologists, and we want to make these skills more accessible to the next generation of biologists, empowering students of all backgrounds and historically under-represented groups in particular.</p>
<p>If you would like to support us, please consider buying a copy to gift to a friend or colleague, if it is within your means. If your budget is tight, then please consider posting a thoughtful and supportive review on Amazon, Barnes &amp; Noble, Apple Books, Google Play Books, or wherever you read this. A positive review will help others to find the book, which will help to build our small community of biology coders. If you aren’t comfortable posting a 5-star review, please contact us to let us know what we can do to bring the next iteration of this book up to your standards.</p>
<p>As you develop your coding skills, consider making recommendations to help improve our books. The most efficient way to do this is by posting an <em>issue</em> in Github. Alternatively, you can find up-to-date contact information on our lab website.</p>
<p>As you continue on your journey, remember that learning to code is different from most biology that you’ve learned. To <em>really</em> learn to code, you must continue to immerse yourself, study, read, try something new, fail, correct, and repeat. And of course: practice, Practice PRACTICE!</p>
</section>
<section id="picture-a-coder" class="level2">
<h2 class="anchored" data-anchor-id="picture-a-coder">Picture a Coder</h2>
<p>Thinking back on what I’ve learned in coding in R, Python, and Unix since 2009, one thing sticks out as particularly helpful for solidifying my understanding of code: helping others. This book began as a series of self tutorials to teach coding to biologists. This came on the heels of helping with full-day coding workshops with what is now called the <em>Centre for Advanced Computing</em> at Queen’s University. It continues all the way back to my experience as a graduate TA helping with statistics, and offering help to other graduate students who were new to R. All of these experiences helped to reveal my own knowledge gaps and offered opportunities to practice my skills. If you found this book helpful, and you want to continue to develop your skills, this is the best advice I can offer: <strong>Pay it forward</strong>.</p>
<p>Please share your knowledge and experiences with others. As you continue to learn and explore R programming, consider sharing your insights and discoveries with your peers and colleagues. This will help to build a supportive community, and you will probably find that helping others helps you hone your own skills.</p>
<p>Let us conclude by reviewing your answer to the preface of this book when you were asked to Think of a computer programmer or data scientist.</p>
<blockquote class="blockquote">
<p><strong>Question</strong>: What does a computer programmer look like?</p>
</blockquote>
<p>Can you picture yourself in that role? If you completed this book, you should!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R Crash Course for Biologists</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://EcoEvoGeno.org/">Robert I Colautti</a></p>
</div>
  </div>
</footer>




</body></html>